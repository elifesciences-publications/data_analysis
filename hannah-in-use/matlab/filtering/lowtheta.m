function y = lowtheta(x)
%LOWTHETA Filters input x and returns output y.
% bandpass filters in 5-7hz

% MATLAB Code
% Generated by MATLAB(R) 9.1 and the DSP System Toolbox 9.3.
% Generated on: 10-May-2018 14:36:25

%#codegen

% To generate C/C++ code from this function use the codegen command. Type
% 'help codegen' for more information.

persistent Hd;

if isempty(Hd)

    % The following code was used to design the filter coefficients:
    % % FIR Window Bandpass filter designed using the FIR1 function.
    %
    % % All frequency values are in Hz.
    % Fs = 2000;  % Sampling Frequency
    %
    % N    = 500;      % Order
    % Fc1  = 5;        % First Cutoff Frequency
    % Fc2  = 7;        % Second Cutoff Frequency
    % flag = 'scale';  % Sampling Flag
    % % Create the window vector for the design algorithm.
    % win = blackman(N+1);
    %
    % % Calculate the coefficients using the FIR1 function.
    % b  = fir1(N, [Fc1 Fc2]/(Fs/2), 'bandpass', win, flag);

    Hd = dsp.FIRFilter( ...
        'Numerator', [0 -2.32187488689393e-09 -1.85907232024751e-08 ...
        -6.27962819417494e-08 -1.48973935072516e-07 -2.91203513285072e-07 ...
        -5.03607944684465e-07 -8.00351708352032e-07 -1.19563904300165e-06 ...
        -1.70371186340879e-06 -2.33884733790385e-06 -3.11535508098579e-06 ...
        -4.04757391603244e-06 -5.14986816416012e-06 -6.4366234165022e-06 ...
        -7.92224174855521e-06 -9.62113633674965e-06 -1.15477254390648e-05 ...
        -1.37164257033028e-05 -1.61416447685643e-05 -1.88377731275328e-05 ...
        -2.18191752193555e-05 -2.51001797252206e-05 -2.86950690411463e-05 ...
        -3.26180679050334e-05 -3.68833311576677e-05 -4.15049306200866e-05 ...
        -4.64968410725603e-05 -5.18729253233331e-05 -5.76469183582737e-05 ...
        -6.38324105656295e-05 -7.04428300332117e-05 -7.74914239185086e-05 ...
        -8.49912388954638e-05 -9.29551006849086e-05 -0.000101395592678958 ...
        -0.000110325033672985 -0.000119755454722154 -0.000129698575142816 ...
        -0.000140165777682454 -0.000151168082885176 -0.000162716122683108 ...
        -0.000174820113247305 -0.000187489827135114 -0.000200734564774088 ...
        -0.000214563125325782 -0.00022898377697582 -0.000244004226699732 ...
        -0.000259631589556966 -0.000275872357568426 -0.00029273236823564 ...
        -0.000310216772762404 -0.00032833000404229 -0.000347075744477926 ...
        -0.000366456893700293 -0.000386475536258513 -0.000407132909352697 ...
        -0.000428429370684369 -0.000450364366500807 -0.000472936399911252 ...
        -0.000496142999554471 -0.000519980688698452 -0.000544444954854193 ...
        -0.000569530219986498 -0.000595229811405545 -0.000621535933423541 ...
        -0.000648439639861306 -0.000675930807489779 -0.000703998110491573 ...
        -0.000732628996027518 -0.000761809660992806 -0.000791525030046829 ...
        -0.000821758735000055 -0.000852493095640358 -0.000883709102080084 ...
        -0.000915386398703801 -0.000947503269795154 -0.000980036626919507 ...
        -0.00101296199813712 -0.00104625351911952 -0.00107988392623935 ...
        -0.00111382455170154 -0.00114804532078089 -0.00118251475122834 ...
        -0.0012171999549051 -0.00125206664170057 -0.00128707912578669 ...
        -0.00132220033425762 -0.00135739181820006 -0.00139261376623567 ...
        -0.00142782502057287 -0.00146298309560121 -0.00149804419905741 ...
        -0.00153296325578732 -0.00156769393412394 -0.0016021886748967 ...
        -0.00163639872308268 -0.00167027416210529 -0.0017037639507815 ...
        -0.00173681596291306 -0.00176937702951281 -0.00180139298365135 ...
        -0.00183280870790482 -0.0018635681843788 -0.00189361454727851 ...
        -0.00192289013798997 -0.00195133656263174 -0.00197889475203155 ...
        -0.00200550502407669 -0.00203110714838234 -0.00205564041321621 ...
        -0.00207904369461334 -0.00210125552760948 -0.00212221417951651 ...
        -0.00214185772515875 -0.00216012412398376 -0.0021769512989569 ...
        -0.00219227721714393 -0.00220603997188199 -0.00221817786643414 ...
        -0.00222862949901939 -0.00223733384910512 -0.00224423036484569 ...
        -0.00224925905154674 -0.00225236056103134 -0.00225347628178087 ...
        -0.00225254842972006 -0.00224952013951283 -0.00224433555623278 ...
        -0.00223693992726948 -0.00222727969432959 -0.00221530258538945 ...
        -0.00220095770645425 -0.00218419563297685 -0.0021649685007884 ...
        -0.0021432300963913 -0.00211893594646451 -0.00209204340643044 ...
        -0.00206251174793229 -0.00203030224507071 -0.00199537825924866 ...
        -0.00195770532247405 -0.00191725121897004 -0.00187398606494444 ...
        -0.00182788238637027 -0.00177891519463166 -0.00172706205989055 ...
        -0.00167230318203226 -0.00161462145904973 -0.00155400255272944 ...
        -0.00149043495150448 -0.00142391003034349 -0.00135442210754772 ...
        -0.00128196849833181 -0.00120654956506817 -0.0011281687640785 ...
        -0.0010468326888609 -0.000962551109645116 -0.000875337009173613 ...
        -0.000785206614611188 -0.000692179425490886 -0.000596278237609677 ...
        -0.00049752916279288 -0.000395961644452139 -0.00029160846886786 ...
        -0.000184505772133104 -7.46930427022683e-05 3.77868805055438e-05 ...
        0.000152887814492023 0.000270560243090941 0.000390751332434985 ...
        0.000513404951001395 0.000638461694252119 0.000765858913877577 ...
        0.000895530751645473 0.00102740817784927 0.00116141903434332 ...
        0.00129748808214457 0.00143553705357329 0.0015754847088981 ...
        0.00171724689744298 0.00186073662310701 0.00200586411424001 ...
        0.00215253689781024 0.00230065987779298 0.00245013541770202 ...
        0.00260086342717875 0.00275274145254694 0.0029056647712343 ...
        0.0030595264899554 0.00321421764654402 0.00336962731531636 ...
        0.0035256427158408 0.00368214932498341 0.00383903099209273 ...
        0.00399617005718177 0.00415344747195956 0.00431074292355936 ...
        0.00446793496080575 0.00462490112285782 0.00478151807006131 ...
        0.00493766171683817 0.005093207366438 0.00524802984737201 ...
        0.0054020036513468 0.00555500307251184 0.0057069023478318 ...
        0.00585757579839209 0.00600689797144384 0.00615474378299236 ...
        0.00630098866073145 0.00644550868712468 0.00658818074243337 ...
        0.00672888264749075 0.00686749330602068 0.00700389284629986 ...
        0.00713796276196218 0.00726958605174478 0.00739864735797591 ...
        0.0075250331036061 0.00764863162758567 0.00776933331839336 ...
        0.00788703074552296 0.00800161878873751 0.00811299476490329 ...
        0.00822105855221875 0.00832571271165752 0.00842686260544737 ...
        0.00852441651241219 0.00861828574000719 0.00870838473288291 ...
        0.00879463117781814 0.00887694610486683 0.00895525398456982 ...
        0.00902948282108743 0.00909956424111502 0.0091654335784499 ...
        0.00922702995408356 0.00928429635170079 0.00933717968847288 ...
        0.00938563088103982 0.00942960490658308 0.00946906085889778 ...
        0.00950396199938075 0.00953427580285822 0.00955997399818472 ...
        0.00958103260355242 0.00959743195645825 0.00960915673828381 ...
        0.0096161959934513 0.00961854314312697 0.0096161959934513 ...
        0.00960915673828381 0.00959743195645825 0.00958103260355242 ...
        0.00955997399818472 0.00953427580285822 0.00950396199938075 ...
        0.00946906085889778 0.00942960490658308 0.00938563088103982 ...
        0.00933717968847288 0.00928429635170079 0.00922702995408356 ...
        0.0091654335784499 0.00909956424111502 0.00902948282108743 ...
        0.00895525398456982 0.00887694610486683 0.00879463117781814 ...
        0.00870838473288291 0.00861828574000719 0.00852441651241219 ...
        0.00842686260544737 0.00832571271165752 0.00822105855221875 ...
        0.00811299476490329 0.00800161878873751 0.00788703074552296 ...
        0.00776933331839336 0.00764863162758567 0.0075250331036061 ...
        0.00739864735797591 0.00726958605174478 0.00713796276196218 ...
        0.00700389284629986 0.00686749330602068 0.00672888264749075 ...
        0.00658818074243337 0.00644550868712468 0.00630098866073145 ...
        0.00615474378299236 0.00600689797144384 0.00585757579839209 ...
        0.0057069023478318 0.00555500307251184 0.0054020036513468 ...
        0.00524802984737201 0.005093207366438 0.00493766171683817 ...
        0.00478151807006131 0.00462490112285782 0.00446793496080575 ...
        0.00431074292355936 0.00415344747195956 0.00399617005718177 ...
        0.00383903099209273 0.00368214932498341 0.0035256427158408 ...
        0.00336962731531636 0.00321421764654402 0.0030595264899554 ...
        0.0029056647712343 0.00275274145254694 0.00260086342717875 ...
        0.00245013541770202 0.00230065987779298 0.00215253689781024 ...
        0.00200586411424001 0.00186073662310701 0.00171724689744298 ...
        0.0015754847088981 0.00143553705357329 0.00129748808214457 ...
        0.00116141903434332 0.00102740817784927 0.000895530751645473 ...
        0.000765858913877577 0.000638461694252119 0.000513404951001395 ...
        0.000390751332434985 0.000270560243090941 0.000152887814492023 ...
        3.77868805055438e-05 -7.46930427022683e-05 -0.000184505772133104 ...
        -0.00029160846886786 -0.000395961644452139 -0.00049752916279288 ...
        -0.000596278237609677 -0.000692179425490886 -0.000785206614611188 ...
        -0.000875337009173613 -0.000962551109645116 -0.0010468326888609 ...
        -0.0011281687640785 -0.00120654956506817 -0.00128196849833181 ...
        -0.00135442210754772 -0.00142391003034349 -0.00149043495150448 ...
        -0.00155400255272944 -0.00161462145904973 -0.00167230318203226 ...
        -0.00172706205989055 -0.00177891519463166 -0.00182788238637027 ...
        -0.00187398606494444 -0.00191725121897004 -0.00195770532247405 ...
        -0.00199537825924866 -0.00203030224507071 -0.00206251174793229 ...
        -0.00209204340643044 -0.00211893594646451 -0.0021432300963913 ...
        -0.0021649685007884 -0.00218419563297685 -0.00220095770645425 ...
        -0.00221530258538945 -0.00222727969432959 -0.00223693992726948 ...
        -0.00224433555623278 -0.00224952013951283 -0.00225254842972006 ...
        -0.00225347628178087 -0.00225236056103134 -0.00224925905154674 ...
        -0.00224423036484569 -0.00223733384910512 -0.00222862949901939 ...
        -0.00221817786643414 -0.00220603997188199 -0.00219227721714393 ...
        -0.0021769512989569 -0.00216012412398376 -0.00214185772515875 ...
        -0.00212221417951651 -0.00210125552760948 -0.00207904369461334 ...
        -0.00205564041321621 -0.00203110714838234 -0.00200550502407669 ...
        -0.00197889475203155 -0.00195133656263174 -0.00192289013798997 ...
        -0.00189361454727851 -0.0018635681843788 -0.00183280870790482 ...
        -0.00180139298365135 -0.00176937702951281 -0.00173681596291306 ...
        -0.0017037639507815 -0.00167027416210529 -0.00163639872308268 ...
        -0.0016021886748967 -0.00156769393412394 -0.00153296325578732 ...
        -0.00149804419905741 -0.00146298309560121 -0.00142782502057287 ...
        -0.00139261376623567 -0.00135739181820006 -0.00132220033425762 ...
        -0.00128707912578669 -0.00125206664170057 -0.0012171999549051 ...
        -0.00118251475122834 -0.00114804532078089 -0.00111382455170154 ...
        -0.00107988392623935 -0.00104625351911952 -0.00101296199813712 ...
        -0.000980036626919507 -0.000947503269795154 -0.000915386398703801 ...
        -0.000883709102080084 -0.000852493095640358 -0.000821758735000055 ...
        -0.000791525030046829 -0.000761809660992806 -0.000732628996027518 ...
        -0.000703998110491573 -0.000675930807489779 -0.000648439639861306 ...
        -0.000621535933423541 -0.000595229811405545 -0.000569530219986498 ...
        -0.000544444954854193 -0.000519980688698452 -0.000496142999554471 ...
        -0.000472936399911252 -0.000450364366500807 -0.000428429370684369 ...
        -0.000407132909352697 -0.000386475536258513 -0.000366456893700293 ...
        -0.000347075744477926 -0.00032833000404229 -0.000310216772762404 ...
        -0.00029273236823564 -0.000275872357568426 -0.000259631589556966 ...
        -0.000244004226699732 -0.00022898377697582 -0.000214563125325782 ...
        -0.000200734564774088 -0.000187489827135114 -0.000174820113247305 ...
        -0.000162716122683108 -0.000151168082885176 -0.000140165777682454 ...
        -0.000129698575142816 -0.000119755454722154 -0.000110325033672985 ...
        -0.000101395592678958 -9.29551006849086e-05 -8.49912388954638e-05 ...
        -7.74914239185086e-05 -7.04428300332117e-05 -6.38324105656295e-05 ...
        -5.76469183582737e-05 -5.18729253233331e-05 -4.64968410725603e-05 ...
        -4.15049306200866e-05 -3.68833311576677e-05 -3.26180679050334e-05 ...
        -2.86950690411463e-05 -2.51001797252206e-05 -2.18191752193555e-05 ...
        -1.88377731275328e-05 -1.61416447685643e-05 -1.37164257033028e-05 ...
        -1.15477254390648e-05 -9.62113633674965e-06 -7.92224174855521e-06 ...
        -6.4366234165022e-06 -5.14986816416012e-06 -4.04757391603244e-06 ...
        -3.11535508098579e-06 -2.33884733790385e-06 -1.70371186340879e-06 ...
        -1.19563904300165e-06 -8.00351708352032e-07 -5.03607944684465e-07 ...
        -2.91203513285072e-07 -1.48973935072516e-07 -6.27962819417494e-08 ...
        -1.85907232024751e-08 -2.32187488689393e-09 0]);
end

delay = mean(grpdelay(Hd));
y = step(Hd,(x));
y(1:delay) = [];


% [EOF]
