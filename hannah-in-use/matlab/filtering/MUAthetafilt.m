function y = MUAthetafilt(x)
%DOFILTER Filters input x and returns output y.

% MATLAB Code
% Generated by MATLAB(R) 9.5 and DSP System Toolbox 9.7.
% Generated on: 01-Mar-2019 15:47:07

%#codegen

% To generate C/C++ code from this function use the codegen command.
% Type 'help codegen' for more information.

persistent Hd;

if isempty(Hd)

    % The following code was used to design the filter coefficients:
    %
    % N     = 100;  % Order
    % F3dB1 = 4;    % First
    % F3dB2 = 12;   % Second
    % Fs    = 40;   % Sampling Frequency
    %
    % h = fdesign.bandpass('n,f3db1,f3db2', N, F3dB1, F3dB2, Fs);
    %
    % Hd = design(h, 'butter', ...
    %     'SystemObject', true);

    Hd = dsp.BiquadFilter( ...
        'Structure', 'Direct form II', ...
        'SOSMatrix', [1 0 -1 1 0.606493431160716 0.963737606953508; 1 0 -1 1 ...
        -1.59964583732326 0.977430212588853; 1 0 -1 1 0.582678476099818 ...
        0.895011602312609; 1 0 -1 1 -1.56328555487613 0.933731509925626; 1 0 -1 ...
        1 -1.52737184244577 0.891768018349823; 1 0 -1 1 0.557944960247239 ...
        0.830911598275229; 1 0 -1 1 -1.49177864475387 0.851338911323659; 1 0 -1 ...
        1 0.532339775904943 0.770974489324173; 1 0 -1 1 -1.45638232078361 ...
        0.812265129540116; 1 0 -1 1 0.505884896067004 0.714800415481544; 1 0 -1 ...
        1 -1.42105963385422 0.774385895385056; 1 0 -1 1 0.478580254933207 ...
        0.662043925461591; 1 0 -1 1 -1.38568566913686 0.737555820773871; 1 0 -1 ...
        1 0.450405567436528 0.612406830628095; 1 0 -1 1 -1.35013159410763 ...
        0.7016424987944; 1 0 -1 1 0.421321221899101 0.565632491542039; 1 0 -1 1 ...
        -1.31426216179893 0.666524499835149; 1 0 -1 1 0.391268311865129 ...
        0.52150135119415; 1 0 -1 1 -1.27793283320122 0.632089720291929; 1 0 -1 1 ...
        0.360167810647102 0.479827595807293; 1 0 -1 1 -1.2409863612324 ...
        0.598234060356507; 1 0 -1 1 0.327918828968486 0.440456891202817; 1 0 -1 ...
        1 -1.20324863098444 0.5648604419607; 1 0 -1 1 0.294395826341352 ...
        0.403265217561706; 1 0 -1 1 -1.16452348556962 0.531878226799921; 1 0 -1 ...
        1 0.25944456469484 0.368158918318523; 1 0 -1 1 -1.12458618055786 ...
        0.499203171548485; 1 0 -1 1 0.222876493647263 0.335076205401964; 1 0 -1 ...
        1 -1.08317500413202 0.46675818863563; 1 0 -1 1 0.184461141106829 ...
        0.303990547241311; 1 0 -1 1 -1.03998049247173 0.434475414969267; 1 0 -1 ...
        1 0.143915967645858 0.274916645826285; 1 0 -1 1 -0.994631626995094 ...
        0.402300521730382; 1 0 -1 1 0.100893094268734 0.247920142014688; 1 0 -1 ...
        1 -0.946678624310216 0.370201007935061; 1 0 -1 1 0.0549625327512838 ...
        0.223132849932803; 1 0 -1 1 -0.895572989858515 0.338181754158457; 1 0 -1 ...
        1 0.0055926041711024 0.200776265993723; 1 0 -1 1 -0.840648925372112 ...
        0.306313970609674; 1 0 -1 1 -0.0478683525492139 0.181197161218519; 1 0 ...
        -1 1 -0.781119794457011 0.274788612587832; 1 0 -1 1 -0.106195268435917 ...
        0.164919107533354; 1 0 -1 1 -0.71612757026348 0.244011880325545; 1 0 -1 ...
        1 -0.170236697212008 0.15270823968353; 1 0 -1 1 -0.644933557138973 ...
        0.214760001078909; 1 0 -1 1 -0.240723935257393 0.145626420140269; 1 0 -1 ...
        1 -0.567396107564571 0.188366050005191; 1 0 -1 1 -0.317793182947628 ...
        0.144973365044463; 1 0 -1 1 -0.484765731724498 0.166749899856113; 1 0 -1 ...
        1 -0.400190346605642 0.151917661350836], ...
        'ScaleValues', [0.579197612802005; 0.579197612802005; ...
        0.563124735956249; 0.563124735956249; 0.54840401671901; ...
        0.54840401671901; 0.534910509717585; 0.534910509717585; ...
        0.522535378694385; 0.522535378694385; 0.511183536093375; ...
        0.511183536093375; 0.500771686339821; 0.500771686339821; ...
        0.491226696958615; 0.491226696958615; 0.482484237238439; ...
        0.482484237238439; 0.474487636321981; 0.474487636321981; ...
        0.467186922158933; 0.467186922158933; 0.460538010291503; ...
        0.460538010291503; 0.454502017406026; 0.454502017406026; ...
        0.449044679327716; 0.449044679327716; 0.444135856926696; ...
        0.444135856926696; 0.439749116448847; 0.439749116448847; ...
        0.435861373244668; 0.435861373244668; 0.432452589867389; ...
        0.432452589867389; 0.429505521145176; 0.429505521145176; ...
        0.427005500177245; 0.427005500177245; 0.424940260320459; ...
        0.424940260320459; 0.42329978916902; 0.42329978916902; ...
        0.422076211323783; 0.422076211323783; 0.421263697430435; ...
        0.421263697430435; 0.420858397563095; 0.420858397563095; 1]);
end

d = step(Hd,x);
delay = mean(grpdelay(Hd));
d(1:delay) = [];
y = d;
